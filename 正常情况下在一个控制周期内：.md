**正常情况下在一个控制周期内：**

1.计算当前功率（仅供观测）：用当前转速和反馈扭矩

2.计算理论功率：使用当前转速和PID输出扭矩

3.计算出理论功率后对整体进行缩放得到缩放功率

4.根据缩放功率和当前转速得到最终输出扭矩



**现在的问题**：

不知道3.中的整体中的其他舵轮轮组的功率



**评估方法的好坏：**

1.PID能否达到及时的控制效果

2.功率控制是否能做到准确



**现在采用的方法：**

一个轮组计算出理论功率之后向c板发送自身理论功率（时刻A），c板在经过缩放之后将缩放功率发送给各轮组，各轮组再根据缩放功率和当前转速计算出最终输出扭矩（时刻B）。



**现方法存在的问题：**

假设总功率未超出限制，即缩放功率等于预期功率的情况

B时刻计算最终输出扭矩时用的是A时刻的预期功率，转速发生了不大的变化

对于这个不大的变化：

1.A时刻的PID输出量作用在了B时刻的实体

2实际上只要功率模型够准的情况，根据B时刻的转速和A时刻的期望功率计算出的转矩是没问题的，但是控制效果未知



**改进：**

底盘can网络：c板can1 TO 舵小板can2

**c板在底盘can网络向四个舵小板发送矢量速度以及限制功率（1000hz）（标准帧）**

c板can1压力：1000x4hz	单舵小板can2压力：1000hz

**舵小板之间在底盘can网络发送自身理论功率（1000hz）**

c板can1压力：1000x4hz+0（可屏蔽掉，无关c板）	单舵小板can2压力：（1000+1000x3）hz

> 感觉发计算后的功率就行

舵小板之间的通信从0x02a到0x02d



接受power_limit_max,expect_total_power





现在功率的缩放系数是在底盘代码中进行计算的，向舵小板发送缩放后的功率scaled_power



